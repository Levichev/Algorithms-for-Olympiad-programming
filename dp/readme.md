# Мануал по ДП
---
Динамическое программирование  — способ решения сложных задач путём разбиения их на более простые подзада.  
  
Структура ДП  
Чтобы успешно решить задачу динамикой нужно:
1) Состояние динамики: параметр(ы), однозначно задающие подзадачу.
2) Значения начальных состояний.
3) Переходы между состояниями: формула пересчёта.
4) Порядок пересчёта.
5) Положение ответа на задачу: иногда это сумма или, например, максимум из значений нескольких состояний.


## Задача о Рюкзаке


**Задача о рюкзаке** (англ. Knapsack problem) — дано **N** предметов, **n[i]** предмет имеет массу **w[i] > 0** и стоимость **p[i] > 0**. Необходимо выбрать из этих предметов такой набор, чтобы суммарная масса не превосходила заданной величины **W** (вместимость рюкзака), а суммарная стоимость была максимальна.

Есть несколько вариаций этой задачи, рассмотрим некоторые из них в порядке возрастания сложности  

1)
- **w[i] == c[i]**  
- **∑w[i] <= W**  
- **∑w[i] → max**  

**Решение:**  
База
```python
for i = 1..W:
  dp[i][0] = 0
  
for j = 0..N:
  dp[0][j] = 1
```
### Состояние
**d[i][j]** - можно ли набрать сумму **j** с помощью первых **i** предметов (Не обязательно брать все предметы) 

### Формула
**d[i][j] = max( d[i-1][j], d[i-1][j-w[i]] )**

### Ответ
```python
for i = W..0:
  if dp[N][i] == 1:
    ans = i
```
**w[i]** == **c[i]**  
### Рассмотрим пример;
**N = 4**
w = {3, 2, 6, 4}  

![Frame 16](https://user-images.githubusercontent.com/35433764/114986024-281ce080-9e9c-11eb-9058-07ca9cac690c.png)  

### Заполняем базу:
- Используя ноль предметов можем набрать только вес равный **0**
- Чтобы набрать вес **0** можно использовать любое количество предметов (можно не заносить в базу, а считать на каждом шаге)
  
На каждом шаге динамики проверяем возможно ли мы набрать вес **j**, использую **i** предметов.  
### Когда это возможно сделать?  
- возможно набрать вес **j**, использя меньшее количество предметов (проверяем {i-1, j} состояние)  
- возможно набрать вес **j - w[i]**, используя меньшее количество предметов(проверяем {i-1,j-w[i]} состояние), где w[i] вес рассматриваемого предмета  

![Frame 17](https://user-images.githubusercontent.com/35433764/114986023-27844a00-9e9c-11eb-9c4b-798c18c5a815.png)  
**d[1][3] = max(d[1-1][3], d[1-1][3-3])**  
Так как можно набрать вес **j - w[i]** (3 - 3), используя меньшее количество предметов, то можно набрать вес **j** (равный 3), используя предмет i(w[i] = 3)  
![Frame 18](https://user-images.githubusercontent.com/35433764/114986022-27844a00-9e9c-11eb-912f-ea8e78ca861b.png)  
Аналогично  
![Frame 19](https://user-images.githubusercontent.com/49977820/114995364-67e8c580-9ea6-11eb-95c0-0d54836f249b.png)  
![Frame 20](https://user-images.githubusercontent.com/49977820/114995302-5acbd680-9ea6-11eb-8e3a-39bcf7b8ce9c.png)  
![Frame 21](https://user-images.githubusercontent.com/35433764/114986016-25ba8680-9e9c-11eb-8718-54eb8f0d45e2.png)  
### Для восставновелние ответа нужно:
1. запомнить конечный вес
2. пока мы можем набрать тот же вес, используя меньшее количество предметов, переходить в состояние с меньшим количеством предметов
3. Если индекс предмета **0**(нет предметов) - перейти к пункут 6, иначе добавить индекс предмета в массив ответа
4. перейти в состояние без **w[i]** предмета (**d[i-1][j - w[i]]**)
5. перейти к пункту 3
6. вывести массив ответа(возможно в обратном порядке)



## Задача о Рюкзаке со стоимостью

2.  
- **w[i]** != **c[i]**  
- **∑w[i] <= W**  
- **∑s[i] → max**  
![Frame 9](https://user-images.githubusercontent.com/35433764/114986394-9cf01a80-9e9c-11eb-8710-a75e970b0b26.png)
![Frame 10](https://user-images.githubusercontent.com/35433764/114986392-9cf01a80-9e9c-11eb-988b-6528608bc1ef.png)  
![Frame 11](https://user-images.githubusercontent.com/35433764/114986390-9c578400-9e9c-11eb-85aa-83799bdf39e8.png)
![Frame 12](https://user-images.githubusercontent.com/35433764/114986388-9c578400-9e9c-11eb-8909-c62e3d2b97ed.png)
![Frame 13](https://user-images.githubusercontent.com/35433764/114986386-9bbeed80-9e9c-11eb-898c-6e9b08b23fa0.png)
![Frame 14](https://user-images.githubusercontent.com/35433764/114986382-9b265700-9e9c-11eb-8c17-a89c11dfffae.png)
![Frame 15](https://user-images.githubusercontent.com/35433764/114986381-9a8dc080-9e9c-11eb-8af5-ac275c5061bc.png)
